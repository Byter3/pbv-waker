# docker-compose.yml
# Wake On LAN Service for Portainer deployment

services:
  pbv-waker:
    build:
      context: .
      dockerfile: Dockerfile
    
    container_name: pbv-waker
    restart: unless-stopped
    
    # Use host network for Wake-on-LAN magic packets to work
    # WoL requires sending broadcast packets on the local network
    network_mode: host
    
    volumes:
      # Persist data files outside container
      - ./workstations.json:/app/workstations.json
      - ./users.json:/app/users.json
      - ./ha_config.json:/app/ha_config.json
      - ./ad_config.json:/app/ad_config.json
      - ./plugs.json:/app/plugs.json
    
    environment:
      - FLASK_ENV=production

  # Optional: Uncomment if you want nginx reverse proxy
  # Note: When using host network mode for pbv-waker, 
  # reverse-proxy needs different config
  # reverse-proxy:
  #   build:
  #     context: ./NGNIX Docker
  #     dockerfile: Dockerfile
  #   container_name: pbv-waker-proxy
  #   restart: unless-stopped
  #   ports:
  #     - "80:80"
  #   depends_on:
  #     - pbv-waker